/** xj.viewport(视窗属性设置) | V0.3.2 | Apache Licence 2.0 | 2015-2022 © XJ.Chen | https://github.com/xjZone/xj.viewport/ */
!function(a,b){"function"!=typeof define||void 0===define.amd&&void 0===define.cmd?"undefined"!=typeof module&&"object"==typeof exports?module.exports=b():(a=a||self,a.xj||(a.xj={}),a.xj.viewport=b()):define(b)}(this,function(){"use strict";var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof self?self:global,c="0.3.2",e={manual:!1,betkbd:240},f={minWidth:0,minHeight:0,width:"auto",height:"auto",maxWidth:"none",maxHeight:"none",onlyMobile:!0,fillScreen:!1,delayReset:500,initialScale:"auto",minimumScale:"none",maximumScale:"none",userScalable:"none",targetDensitydpi:"",viewportFit:"",resize:!0};return void 0===a.xj&&(a.xj={}),void 0===a.xj.viewportReturn&&(a.xj.viewportReturn={}),void 0!==a.xj.viewportReturn[c]?a.xj.viewportReturn[c]:(void 0===a.xj.viewportConfig&&(a.xj.viewportConfig={}),void 0===a.xj.viewportOption&&(a.xj.viewportOption={}),void 0!==a.xj.viewportConfig[c]&&Object.keys(a.xj.viewportConfig[c]).forEach(function(b){e[b]=a.xj.viewportConfig[c][b]}),void 0!==a.xj.viewportOption[c]&&Object.keys(a.xj.viewportOption[c]).forEach(function(b){f[b]=a.xj.viewportOption[c][b]}),g=a,h=g.document,i=h.documentElement,j=h.body,k=h.querySelector('meta[name="viewport"]'),l=/Mobile|Android|iPhone|iPad/i.test(navigator.userAgent),m=l&&/Apple/i.test(navigator.vendor)?!0:!1,n=function(){k.setAttribute("content","width=device-width,initial-scale=1")},o=function(){return l===!1?g.innerWidth>g.innerHeight?"landscape":g.innerWidth<g.innerHeight?"portrait":"squared":m===!0?i.clientWidth>i.clientHeight?"landscape":i.clientWidth<i.clientHeight?"portrait":"squared":screen.width>screen.height?"landscape":screen.width<screen.height?"portrait":"squared"},p=/Firefox/i.test(navigator.userAgent)===!0?"MozUserModify":"webkitUserModify",q=function(a,b){return g.getComputedStyle(a,b?b:null)},r=function(a){return/^input|textarea$/i.test(a.nodeName)===!0?!1:a.isContentEditable===!0||void 0===h.documentMode&&/write/i.test(q(a)[p])===!0?!0:!1},s=function(){return parseFloat(k.content.match(/initial-scale=([^,]+)/i)[1].trim())},t=!0,function(a,b){try{a=h.createElement("input"),a.type="color",a.value="!",b="color"===a.type&&"!"!==a.value}catch(c){}b===!1&&(t=!1)}(null,!1),u=function(){if(l===!1||m===!0)return!1;var a=h.activeElement;if(null===a||a===j||1!==a.nodeType)return!1;if(/^input|textarea$/i.test(a.nodeName)===!0){if(/^color$/i.test(a.type)===!0&&t===!0)return!1;if(/^textarea|text|email|tel|url|number|search|password|date|time|week|month|range|color$/i.test(a.type)===!1)return!1;if(a.readOnly===!0||a.disabled===!0||a.hasAttribute("readOnly")===!0||a.hasAttribute("disabled")===!0)return!1}return r(a)===!1?!1:screen.height-s()*v.height()<e.betkbd?!1:!0},v={version:c,element:k,orientation:o,softKeyboard:u,width:function(){return Math.round(i.clientWidth)},height:function(){return Math.round(g.innerHeight/g.innerWidth*i.clientWidth)},get:function(){return k.getAttribute("content")},set:function(a){var c,d,e,h,i,j,p,q,r,s,t,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,b=Object.create(null);Object.keys(f).forEach(function(a){b[a]=f[a]}),null!==a&&"object"==typeof a&&Object.keys(a).forEach(function(c){b[c]=a[c]}),c=b.minWidth,d=b.minHeight,e=b.width,h=b.height,i=b.maxWidth,j=b.maxHeight,p=b.onlyMobile,q=b.fillScreen,r=b.delayReset,s=b.initialScale,t=b.minimumScale,w=b.maximumScale,x=b.userScalable,y=b.targetDensitydpi,z=b.viewportFit,A=b.resize,(l!==!1||p!==!0)&&(B=v.width(),C=v.height(),D="",E="",F=1,G=1,H=1,0!==c&&0===d&&c>B?(F=B/c,E=c):0===c&&0!==d&&d>C?(F=C/d,E=Math.round(B*d/C)):0!==c&&0!==d?(c>B||d>C?(c>B&&(G=B/c),d>C&&(H=C/d)):q===!0&&(B>c&&(G=B/c),C>d&&(H=C/d)),(1!==G||1!==H)&&(E=H>=G?c:Math.round(d*B/C),F=Math.min(G,H))):"none"!==i&&"none"===j&&B>i?(F=B/i,E=i):"none"===i&&"none"!==j&&C>j?(F=C/j,E=Math.round(B*j/C)):"none"!==i&&"none"!==j?(B>i||C>j?(B>i&&(G=B/i),C>j&&(H=C/j)):q===!0&&(i>B&&(G=B/i),j>C&&(H=C/j)),(1!==G||1!==H)&&(E=G>=H?i:Math.round(j*B/C),F=Math.max(G,H))):"auto"!==e?(E=e,F="device-width"===e?1:B/e):"auto"!==h&&(E=Math.round(B*h/C),F="device-width"===h?1:C/h),D+="width="+(""===E?"device-width":E),D+=",initial-scale="+("auto"===s?F:initialScale),"none"!==t&&(D+=",minimum-scale="+("auto"===t?F:t)),"none"!==w&&(D+=",maximum-scale="+("auto"===w?F:w)),""!==y&&(D+=",target-densitydpi="+y),"none"!==x&&(D+=",user-scalable="+x),""!==z&&(D+=",viewport-fit="+z),k.setAttribute("content",D),A!==!1&&(I=v.height(),J=0/0,K=o(),L=0,M=void 0,N=!1,g.addEventListener("resize",function(){return/Mobile|Android|iPhone|iPad/i.test(navigator.userAgent)===!1?(n(),b.resize=!1,v.set(b),void 0):((m!==!1||N!==!0)&&(m!==!1||u()!==!0)&&(clearTimeout(M),M=setTimeout(function(){J=v.height(),L=o(),L===K&&J+4>=I||(L!==K||I>J+4)&&(m===!1&&(N=!0),n(),N=!1,b.resize=!1,v.set(b),g.dispatchEvent(new Event("resize",{bubbles:!0,cancelable:!0})),I=v.height(),K=L)},r)),void 0)},!0)))}},e.manual===!1&&k.hasAttribute("xj-viewport")&&(w=eval("("+k.getAttribute("xj-viewport")+")"),void 0!==w&&null!==w&&"object"==typeof w&&v.set(w)),a.xj.viewportReturn[c]=v,v)});
